<UserControl x:Class="TileShop.UI.Features.Graphics.GraphicsEditorToolbarView"
    xmlns="https://github.com/avaloniaui"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:cc="https://github.com/stevemonaco/TileShop"
    xmlns:con="using:TileShop.UI.Converters"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:gfx="using:TileShop.UI.Features.Graphics"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:vm="using:TileShop.UI.ViewModels"
    d:DesignHeight="450"
    d:DesignWidth="800"
    x:DataType="vm:GraphicsEditorViewModel"
    mc:Ignorable="d">
    <!-- <UserControl.ContextMenu> -->
    <!--     <ContextMenu> -->
    <!--         <MenuItem Command="{Binding SelectAllCommand}" Header="Select All" /> -->
    <!--         <MenuItem Command="{Binding ModifyGridSettingsCommand}" Header="Grid Settings..." /> -->
    <!--         <MenuItem Command="{Binding ToggleSymmetryToolsCommand}" Header="Show Symmetry Tools"> -->
    <!--             <Interaction.Behaviors> -->
    <!--                 <DataTriggerBehavior Binding="{Binding #control.((gfx:GraphicsEditorViewModel)DataContext).AreSymmetryToolsEnabled}" Value="True"> -->
    <!--                     <ChangePropertyAction PropertyName="Icon"> -->
    <!--                         <ChangePropertyAction.Value> -->
    <!--                             <PathIcon Classes="menu" Data="{x:Static cc:AppIcons.CheckedBox}" /> -->
    <!--                         </ChangePropertyAction.Value> -->
    <!--                     </ChangePropertyAction> -->
    <!--                 </DataTriggerBehavior> -->
    <!--                 <DataTriggerBehavior Binding="{Binding #control.((gfx:GraphicsEditorViewModel)DataContext).AreSymmetryToolsEnabled}" Value="False"> -->
    <!--                     <ChangePropertyAction PropertyName="Icon"> -->
    <!--                         <ChangePropertyAction.Value> -->
    <!--                             <PathIcon Classes="menu" Data="{x:Static cc:AppIcons.UncheckedBox}" /> -->
    <!--                         </ChangePropertyAction.Value> -->
    <!--                     </ChangePropertyAction> -->
    <!--                 </DataTriggerBehavior> -->
    <!--             </Interaction.Behaviors> -->
    <!--         </MenuItem> -->
    <!--     </ContextMenu> -->
    <!-- </UserControl.ContextMenu> -->

    <Border Width="200" MinWidth="160" Padding="0,0,12,4" TextElement.Foreground="#F9F9F9">
        <StackPanel Spacing="4">
            <!--  Edit Mode Selector  -->
            <StackPanel Classes="toolbar-group">
                <RadioButton Classes="tool" Content="View"
                    IsChecked="{Binding EditMode, Converter={x:Static con:AppConverters.EnumToBoolean}, ConverterParameter=View}"
                    IsVisible="{Binding CanView}" ToolTip.Tip="View-only mode for adjusting codec properties" />
                <RadioButton Classes="tool" Content="Arrange"
                    IsChecked="{Binding EditMode, Converter={x:Static con:AppConverters.EnumToBoolean}, ConverterParameter=Arrange}"
                    IsVisible="{Binding CanArrange}" ToolTip.Tip="Arrange elements within the arranger" />
                <RadioButton Classes="tool" Content="Draw"
                    IsChecked="{Binding EditMode, Converter={x:Static con:AppConverters.EnumToBoolean}, ConverterParameter=Draw}"
                    IsVisible="{Binding CanDraw}" ToolTip.Tip="Draw and edit pixels" />
            </StackPanel>

            <TextBlock Classes="muted" IsVisible="{Binding IsSequentialArranger}"
                Text="{Binding FileOffset, StringFormat='Offset: 0x{0:X}'}" TextWrapping="Wrap" />

            <!--  View Tools  -->
            <StackPanel IsVisible="{Binding IsViewMode}" Spacing="4">
                <TextBlock Margin="0,8,0,0" HorizontalAlignment="Left" Classes="muted" Text="Tools" />

                <StackPanel Classes="toolbar-group">
                    <RadioButton Classes="tool" Command="{Binding ChangeViewToolCommand}"
                        CommandParameter="{x:Static vm:ViewTool.Select}"
                        IsChecked="{Binding ActiveViewTool, Mode=OneWay, Converter={x:Static con:AppConverters.EnumToBoolean}, ConverterParameter=Select}"
                        ToolTip.Tip="Click and drag to select a region">
                        <PathIcon Classes="medium" Data="{x:Static cc:AppIcons.RectangularSelection}" />
                    </RadioButton>
                </StackPanel>
            </StackPanel>

            <!--  Arranger Tools  -->
            <StackPanel IsVisible="{Binding IsArrangerMode}" Spacing="4">
                <TextBlock Margin="0,8,0,0" HorizontalAlignment="Left" Classes="muted" Text="Tools" />

                <StackPanel Classes="toolbar-group">
                    <RadioButton Classes="tool" Command="{Binding ChangeArrangerToolCommand}"
                        CommandParameter="{x:Static vm:ArrangerTool.Select}"
                        IsChecked="{Binding ActiveArrangerTool, Mode=OneWay, Converter={x:Static con:AppConverters.EnumToBoolean}, ConverterParameter=Select}"
                        ToolTip.Tip="Click and drag across Arranger to select a region or hold Ctrl to quickly drag single elements">
                        <PathIcon Classes="medium" Data="{x:Static cc:AppIcons.RectangularSelection}" />
                    </RadioButton>
                    <RadioButton Classes="tool" Command="{Binding ChangeArrangerToolCommand}"
                        CommandParameter="{x:Static vm:ArrangerTool.ApplyPalette}"
                        IsChecked="{Binding ActiveArrangerTool, Mode=OneWay, Converter={x:Static con:AppConverters.EnumToBoolean}, ConverterParameter=ApplyPalette}"
                        ToolTip.Tip="{Binding SelectedPalette.Name, StringFormat='Click on an Arranger element to apply the current palette (\{0\})'}">
                        <PathIcon Classes="medium vflip" Data="{x:Static cc:AppIcons.PaletteBrush}" />
                    </RadioButton>
                    <RadioButton Classes="tool" Command="{Binding ChangeArrangerToolCommand}"
                        CommandParameter="{x:Static vm:ArrangerTool.PickPalette}"
                        IsChecked="{Binding ActiveArrangerTool, Mode=OneWay, Converter={x:Static con:AppConverters.EnumToBoolean}, ConverterParameter=PickPalette}"
                        ToolTip.Tip="Click on an Arranger element to pick its associated palette">
                        <PathIcon Classes="medium" Data="{x:Static cc:AppIcons.PalettePicker}" />
                    </RadioButton>
                    <RadioButton Classes="tool" Command="{Binding ChangeArrangerToolCommand}"
                        CommandParameter="{x:Static vm:ArrangerTool.InspectElement}"
                        IsChecked="{Binding ActiveArrangerTool, Mode=OneWay, Converter={x:Static con:AppConverters.EnumToBoolean}, ConverterParameter=InspectElement}"
                        ToolTip.Tip="Hover Arranger elements to inspect their properties">
                        <PathIcon Classes="medium" Data="{x:Static cc:AppIcons.Eye}" />
                    </RadioButton>

                    <RadioButton Classes="tool" Command="{Binding ChangeArrangerToolCommand}"
                        CommandParameter="{x:Static vm:ArrangerTool.RotateLeft}"
                        IsChecked="{Binding ActiveArrangerTool, Mode=OneWay, Converter={x:Static con:AppConverters.EnumToBoolean}, ConverterParameter=RotateLeft}"
                        IsVisible="{Binding AreSymmetryToolsEnabled}" ToolTip.Tip="Rotate Element's Display Left">
                        <PathIcon Classes="medium" Data="{x:Static cc:AppIcons.RotateLeft}" />
                    </RadioButton>
                    <RadioButton Classes="tool" Command="{Binding ChangeArrangerToolCommand}"
                        CommandParameter="{x:Static vm:ArrangerTool.RotateRight}"
                        IsChecked="{Binding ActiveArrangerTool, Mode=OneWay, Converter={x:Static con:AppConverters.EnumToBoolean}, ConverterParameter=RotateRight}"
                        IsVisible="{Binding AreSymmetryToolsEnabled}" ToolTip.Tip="Rotate Element's Display Right">
                        <PathIcon Classes="medium" Data="{x:Static cc:AppIcons.RotateRight}" />
                    </RadioButton>
                    <RadioButton Classes="tool" Command="{Binding ChangeArrangerToolCommand}"
                        CommandParameter="{x:Static vm:ArrangerTool.MirrorHorizontal}"
                        IsChecked="{Binding ActiveArrangerTool, Mode=OneWay, Converter={x:Static con:AppConverters.EnumToBoolean}, ConverterParameter=MirrorHorizontal}"
                        IsVisible="{Binding AreSymmetryToolsEnabled}" ToolTip.Tip="Mirror Element's Display Horizontally">
                        <PathIcon Classes="medium" Data="{x:Static cc:AppIcons.MirrorHorizontal}" />
                    </RadioButton>
                    <RadioButton Classes="tool" Command="{Binding ChangeArrangerToolCommand}"
                        CommandParameter="{x:Static vm:ArrangerTool.MirrorVertical}"
                        IsChecked="{Binding ActiveArrangerTool, Mode=OneWay, Converter={x:Static con:AppConverters.EnumToBoolean}, ConverterParameter=MirrorVertical}"
                        IsVisible="{Binding AreSymmetryToolsEnabled}" ToolTip.Tip="Mirror Element's Display Vertically">
                        <PathIcon Classes="medium" Data="{x:Static cc:AppIcons.MirrorVertical}" />
                    </RadioButton>
                </StackPanel>
            </StackPanel>

            <!--  Pixel Tools  -->
            <StackPanel IsVisible="{Binding IsDrawMode}" Spacing="4">
                <TextBlock Margin="0,8,0,0" HorizontalAlignment="Left" Classes="muted" Text="Tools" />

                <StackPanel Classes="toolbar-group">
                    <RadioButton Classes="tool" Command="{Binding ChangePixelToolCommand}"
                        CommandParameter="{x:Static vm:PixelTool.Select}"
                        IsChecked="{Binding ActivePixelTool, Mode=OneWay, Converter={x:Static con:AppConverters.EnumToBoolean}, ConverterParameter=Select}"
                        ToolTip.Tip="Click and drag to select a region">
                        <PathIcon Classes="medium" Data="{x:Static cc:AppIcons.RectangularSelection}" />
                    </RadioButton>
                    <RadioButton Classes="tool" Command="{Binding ChangePixelToolCommand}"
                        CommandParameter="{x:Static vm:PixelTool.Pencil}"
                        IsChecked="{Binding ActivePixelTool, Mode=OneWay, Converter={x:Static con:AppConverters.EnumToBoolean}, ConverterParameter=Pencil}"
                        ToolTip.Tip="Draw pixels with primary (left click) or secondary (right click) color">
                        <PathIcon Classes="medium" Data="{x:Static cc:AppIcons.Pencil}" />
                    </RadioButton>
                    <RadioButton Classes="tool" Command="{Binding ChangePixelToolCommand}"
                        CommandParameter="{x:Static vm:PixelTool.ColorPicker}"
                        IsChecked="{Binding ActivePixelTool, Mode=OneWay, Converter={x:Static con:AppConverters.EnumToBoolean}, ConverterParameter=ColorPicker}"
                        ToolTip.Tip="Pick a color from the image">
                        <PathIcon Classes="medium" Data="{x:Static cc:AppIcons.ColorPicker}" />
                    </RadioButton>
                    <RadioButton Classes="tool" Command="{Binding ChangePixelToolCommand}"
                        CommandParameter="{x:Static vm:PixelTool.FloodFill}"
                        IsChecked="{Binding ActivePixelTool, Mode=OneWay, Converter={x:Static con:AppConverters.EnumToBoolean}, ConverterParameter=FloodFill}"
                        ToolTip.Tip="Flood fill an area with primary (left click) or secondary (right click) color">
                        <PathIcon Classes="medium" Data="{x:Static cc:AppIcons.FloodFill}" />
                    </RadioButton>
                </StackPanel>
            </StackPanel>

            <!--  Palette  -->
            <StackPanel IsVisible="{Binding IsIndexedColor}" Spacing="4">
                <TextBlock Margin="0,8,0,0" HorizontalAlignment="Left" Classes="muted" Text="Palette" />

                <StackPanel Orientation="Horizontal">
                    <ComboBox HorizontalAlignment="Stretch" Focusable="False" ItemsSource="{Binding Palettes}"
                        SelectedItem="{Binding SelectedPalette}">
                        <ComboBox.ItemTemplate>
                            <DataTemplate>
                                <TextBlock Text="{Binding Name}" />
                            </DataTemplate>
                        </ComboBox.ItemTemplate>
                    </ComboBox>

                    <Button VerticalAlignment="Bottom" VerticalContentAlignment="Center"
                        Command="{Binding AssociatePaletteCommand}" Focusable="False"
                        ToolTip.Tip="Associate an existing Palette from this Project with this Arranger">
                        <PathIcon Classes="medium" Data="{x:Static cc:AppIcons.PlusCircle}" />
                    </Button>
                </StackPanel>
            </StackPanel>

            <!--  Active Colors (Indexed)  -->
            <StackPanel IsVisible="{Binding IsDrawMode}" Spacing="4">
                <TextBlock Margin="0,8,0,0" HorizontalAlignment="Left" Classes="muted" Text="Colors" />

                <!--  Indexed Colors  -->
                <StackPanel HorizontalAlignment="Left" IsVisible="{Binding IsIndexedColor}" Orientation="Horizontal" Spacing="2">
                    <Border BorderBrush="Black" BorderThickness="2">
                        <Border BorderBrush="White" BorderThickness="2">
                            <Rectangle Width="26" Height="26" ToolTip.Tip="Primary Color">
                                <Rectangle.Fill>
                                    <MultiBinding Converter="{x:Static con:AppConverters.PaletteIndexToBrush}">
                                        <Binding Path="ActivePalette" />
                                        <Binding Path="PrimaryColorIndex" />
                                    </MultiBinding>
                                </Rectangle.Fill>
                            </Rectangle>
                        </Border>
                    </Border>
                    <Border BorderBrush="Black" BorderThickness="2">
                        <Border BorderBrush="White" BorderThickness="2">
                            <Rectangle Width="26" Height="26" ToolTip.Tip="Secondary Color">
                                <Rectangle.Fill>
                                    <MultiBinding Converter="{x:Static con:AppConverters.PaletteIndexToBrush}">
                                        <Binding Path="ActivePalette" />
                                        <Binding Path="SecondaryColorIndex" />
                                    </MultiBinding>
                                </Rectangle.Fill>
                            </Rectangle>
                        </Border>
                    </Border>
                </StackPanel>

                <!--  Direct Colors  -->
                <StackPanel HorizontalAlignment="Left" IsVisible="{Binding IsDirectColor}" Orientation="Horizontal" Spacing="2">
                    <ColorPicker Height="40" Color="{Binding PrimaryColor, Converter={x:Static con:AppConverters.ColorRgba32ToMediaColor}}" />
                    <ColorPicker Height="40" Color="{Binding SecondaryColor, Converter={x:Static con:AppConverters.ColorRgba32ToMediaColor}}" />
                </StackPanel>
            </StackPanel>

            <!--  Options  -->
            <TextBlock Margin="0,8,0,0" HorizontalAlignment="Left" Classes="muted" Text="Options" />

            <StackPanel Orientation="Horizontal">
                <ToggleButton Focusable="False" IsChecked="{Binding GridSettings.ShowGridlines}" ToolTip.Tip="Toggle gridline visibility (G)">
                    <PathIcon Classes="medium" Data="{x:Static cc:AppIcons.Grid}" Foreground="#F9F9F9" />
                </ToggleButton>

                <ToggleButton Focusable="False"
                    IsChecked="{Binding SnapMode, Converter={x:Static con:AppConverters.SnapModeBoolean}}"
                    IsVisible="{Binding CanChangeSnapMode}" ToolTip.Tip="Snap Selection to Elements (S)">
                    <PathIcon Classes="medium" Data="{x:Static cc:AppIcons.Snap}" Foreground="#F9F9F9" />
                </ToggleButton>
            </StackPanel>

            <!--  Arranger Size (Sequential Arranger in Display mode only)  -->
            <StackPanel IsVisible="{Binding IsViewMode}" Spacing="4">
                <TextBlock Margin="0,8,0,0" HorizontalAlignment="Left" Classes="muted" Text="Arranger Size" />
                <StackPanel Orientation="Horizontal" Spacing="4">
                    <Button Command="{Binding ExpandWidthCommand}" Focusable="False" ToolTip.Tip="Expand Width">
                        W+
                    </Button>
                    <Button Command="{Binding ShrinkWidthCommand}" Focusable="False" ToolTip.Tip="Shrink Width">
                        W-
                    </Button>
                </StackPanel>
                <StackPanel Orientation="Horizontal" Spacing="4">
                    <Button Command="{Binding ExpandHeightCommand}" Focusable="False" ToolTip.Tip="Expand Height">
                        H+
                    </Button>
                    <Button Command="{Binding ShrinkHeightCommand}" Focusable="False" ToolTip.Tip="Shrink Height">
                        H-
                    </Button>
                </StackPanel>
            </StackPanel>

            <!--  Actions  -->
            <TextBlock Margin="0,8,0,0" HorizontalAlignment="Left" Classes="muted" Text="Actions" />

            <StackPanel Orientation="Horizontal" Spacing="4">
                <Button Command="{Binding ResizeArrangerCommand}" Focusable="False" IsVisible="{Binding IsTiledLayout}"
                    ToolTip.Tip="Resizes the Arranger">
                    <PathIcon Classes="medium" Data="{x:Static cc:AppIcons.Resize}" />
                </Button>

                <Button Command="{Binding RemapColorsCommand}" Focusable="False" IsEnabled="{Binding CanRemapColors}"
                    IsVisible="{Binding IsIndexedColor}" ToolTip.ShowOnDisabled="True"
                    ToolTip.Tip="Remap Palette Colors">
                    <PathIcon Classes="medium" Data="{x:Static cc:AppIcons.Remap}" />
                </Button>
            </StackPanel>
        </StackPanel>
    </Border>
</UserControl>

